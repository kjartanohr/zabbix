
if [ $1 ] && [ $1 = '--zabbix-test-run' ]
then
  echo ZABBIX TEST OK;
  exit;
fi



perl <<'EOF'
#!/usr/bin/perl

# 2023.01.09

use strict;
use warnings;
use LWP::UserAgent ();
use JSON;
use Data::Dumper;

my $ua = LWP::UserAgent->new(
  timeout           => 10,
  'keep_alive'      => 1,
  #'conn_cache'      => 1,
  'max_redirect'    => 5,
  'max_size'        => 8000,
  'agent'           => 'zabbix trigger agent',

  'ssl_opts'        => { 
    verify_hostname => 0,
  },

);
#$ua->env_proxy;

my $api_user  = 'kfo';
my $api_pass  = 'pCcnx2hPWpBWqVxnpw',
my $api_url   = 'api.kjartanohr.no/data';
my $url       = "https://$api_user:$api_pass\@$api_url";

my %hash = (
  'info'  => {
    'hostname' =>   `hostname`,
  },
);

foreach my $line (readline DATA){
  chomp $line;
  next unless $line;
  next if $line =~ /^#/;

  my ($key, $value) = split/\s{0,}:\s{0,}/, $line;
  unless (defined $key){
    print "No data in \$key. \$line: $line\n";
    next;
  }
  unless (defined $value){
    #print "No data in \$key. \$line: $value\n";
    next;
  }
  next if length $value == 0;
  next if $value =~ /^(?:\*|\{)/;
  $hash{'trigger'}{$key} = $value;
}

#print Dumper %hash;
my $json_string = JSON::encode_json(\%hash);

my $res = $ua->post( $url, 'Content-Type' => 'application/json', 'Content' => $json_string );
print Dumper $res;


__DATA__

alert_message: {ALERT.MESSAGE}

alert_subject: {ALERT.SUBJECT}

event_id: {EVENT.ID}

event_tags: {EVENT.TAGS}

event_update_status: {EVENT.UPDATE.STATUS}

event_value: {EVENT.VALUE}

trigger_id: {TRIGGER.ID}

zbxurl: {$ZABBIX.URL}

zendesk_issue_key: {EVENT.TAGS.__zbx_zdk_issuekey}

HOST.CONN: {HOST.CONN}

HOST.NAME: {HOST.NAME}



EVENT.NAME: {EVENT.NAME}
EVENT.DATE: {EVENT.DATE}
EVENT.TIME: {EVENT.TIME}
EVENT.*: {EVENT.*}:
EVENT.TAGS: {EVENT.TAGS}
EVENT.TAGSJSON: {EVENT.TAGSJSON} 
EVENT.VALUE: {EVENT.VALUE} 
EVENT.STATUS: {EVENT.STATUS} 
EVENT.AGE: {EVENT.AGE}
EVENT.ACK.STATUS: {EVENT.ACK.STATUS} 
EVENT.UPDATE.HISTORY: {EVENT.UPDATE.HISTORY}
EVENT.OPDATA: {EVENT.OPDATA}
EVENT.NSEVERITY: {EVENT.NSEVERITY}
EVENT.OBJECT: {EVENT.OBJECT}
EVENT.SEVERITY: {EVENT.SEVERITY}
EVENT.SOURCE: {EVENT.SOURCE}
EVENT.UPDATE.ACTION: {EVENT.UPDATE.ACTION}


EVENT.UPDATE.DATE: {EVENT.UPDATE.DATE}
ACK.DATE: {ACK.DATE}
EVENT.UPDATE.HISTORY: {EVENT.UPDATE.HISTORY}
EVENT.ACK.HISTORY: {EVENT.ACK.HISTORY}
EVENT.UPDATE.MESSAGE: {EVENT.UPDATE.MESSAGE}
ACK.MESSAGE: {ACK.MESSAGE}
EVENT.UPDATE.NSEVERITY: {EVENT.UPDATE.NSEVERITY}
EVENT.UPDATE.SEVERITY: {EVENT.UPDATE.SEVERITY}
EVENT.UPDATE.STATUS: {EVENT.UPDATE.STATUS}
EVENT.UPDATE.TIME: {EVENT.UPDATE.TIME}
ACK.TIME: {ACK.TIME}
EVENT.VALUE: {EVENT.VALUE}
EVENT.RECOVERY.I: {EVENT.RECOVERY.I}
EVENT.RECOVERY.VALU} : {EVENT.RECOVERY.VALUE} 
EVENT.RECOVERY.STATU} : {EVENT.RECOVERY.STATUS} 
EVENT.RECOVERY.TIME: {EVENT.RECOVERY.TIME}
EVENT.RECOVERY.DATE: {EVENT.RECOVERY.DATE}
EVENT.RECOVERY.NAME: {EVENT.RECOVERY.NAME}
EVENT.RECOVERY.TAGSJSON: {EVENT.RECOVERY.TAGSJSON}

FUNCTION.VALUE1: {FUNCTION.VALUE1}
FUNCTION.VALUE2: {FUNCTION.VALUE2}
FUNCTION.VALUE3: {FUNCTION.VALUE3}
FUNCTION.VALUE4: {FUNCTION.VALUE4}
FUNCTION.VALUE5: {FUNCTION.VALUE5}
FUNCTION.VALUE6: {FUNCTION.VALUE6}
FUNCTION.VALUE7: {FUNCTION.VALUE7}
FUNCTION.VALUE8: {FUNCTION.VALUE8}
FUNCTION.VALUE9: {FUNCTION.VALUE9}

FUNCTION.RECOVERY.VALUE1: {FUNCTION.RECOVERY.VALUE1}
FUNCTION.RECOVERY.VALUE2: {FUNCTION.RECOVERY.VALUE2}
FUNCTION.RECOVERY.VALUE3: {FUNCTION.RECOVERY.VALUE3}
FUNCTION.RECOVERY.VALUE4: {FUNCTION.RECOVERY.VALUE4}
FUNCTION.RECOVERY.VALUE5: {FUNCTION.RECOVERY.VALUE5}
FUNCTION.RECOVERY.VALUE6: {FUNCTION.RECOVERY.VALUE6}
FUNCTION.RECOVERY.VALUE7: {FUNCTION.RECOVERY.VALUE7}
FUNCTION.RECOVERY.VALUE8: {FUNCTION.RECOVERY.VALUE8}
FUNCTION.RECOVERY.VALUE9: {FUNCTION.RECOVERY.VALUE9}

HOST.DESCRIPTION: {HOST.DESCRIPTION}
HOST.METADATA: {HOST.METADATA}


ACTION.ID: {ACTION.ID} 
ACTION.NAME: {ACTION.NAME}
ALERT.MESSAGE: {ALERT.MESSAGE}
ALERT.SENDTO: {ALERT.SENDTO}
ALERT.SUBJECT: {ALERT.SUBJECT}

DATE: {DATE}

DISCOVERY.DEVICE.IPADDRESS: {DISCOVERY.DEVICE.IPADDRESS}
DISCOVERY.DEVICE.DNS: {DISCOVERY.DEVICE.DNS}
DISCOVERY.DEVICE.STATUS: {DISCOVERY.DEVICE.STATUS}
DISCOVERY.DEVICE.UPTIME: {DISCOVERY.DEVICE.UPTIME}
DISCOVERY.RULE.NAME: {DISCOVERY.RULE.NAME}
DISCOVERY.SERVICE.NAME: {DISCOVERY.SERVICE.NAME}
DISCOVERY.SERVICE.PORT: {DISCOVERY.SERVICE.PORT}
DISCOVERY.SERVICE.STATUS: {DISCOVERY.SERVICE.STATUS}



TRIGGER.NAME: {TRIGGER.NAME}

TRIGGER.STATUS: {TRIGGER.STATUS}

TRIGGER.SEVERITY: {TRIGGER.SEVERITY}

TRIGGER.URL: {TRIGGER.URL}

TRIGGER.DESCRIPTION: {TRIGGER.DESCRIPTION}

TRIGGER.EXPRESSION:  {TRIGGER.EXPRESSION}

ITEM.NAME: {ITEM.NAME}

HOST.NAME: {HOST.NAME}

HOST.HOST: {HOST.HOST}

ITEM.KEY: {ITEM.KEY}

ITEM.VALUE: {ITEM.VALUE}

HOST.NAME1: {HOST.NAME1}

ITEM.KEY1: {ITEM.KEY1}

ITEM.VALUE1: {ITEM.VALUE1}

EVENT.ID: {EVENT.ID}

ITEM.VALUE: {ITEM.VALUE}

ITEM.LASTVALUE: {ITEM.LASTVALUE}

INVENTORY.*: {INVENTORY.*}

HOST.DNS: {HOST.DNS}

HOST.PORT: {HOST.PORT}

HOST.ID: {HOST.ID}


HOST.TARGET.CONN: {HOST.TARGET.CONN}
HOST.TARGET.DNS: {HOST.TARGET.DNS}
HOST.TARGET.HOST: {HOST.TARGET.HOST}
HOST.TARGET.IP: {HOST.TARGET.IP}
HOST.TARGET.NAME: {HOST.TARGET.NAME}
HOSTGROUP.ID: {HOSTGROUP.ID}
INVENTORY.ALIAS: {INVENTORY.ALIAS}
INVENTORY.ALIAS<1-9>: {INVENTORY.ALIAS<1-9>}
INVENTORY.ASSET.TAG: {INVENTORY.ASSET.TAG}
INVENTORY.ASSET.TAG<1-9>: {INVENTORY.ASSET.TAG<1-9>}
INVENTORY.CHASSIS: {INVENTORY.CHASSIS}
INVENTORY.CHASSIS<1-9>: {INVENTORY.CHASSIS<1-9>}
INVENTORY.CONTACT: {INVENTORY.CONTACT}
INVENTORY.CONTACT<1-9>: {INVENTORY.CONTACT<1-9>}
PROFILE.CONTACT<1-9>: {PROFILE.CONTACT<1-9>}
INVENTORY.CONTRACT.NUMBER: {INVENTORY.CONTRACT.NUMBER}
INVENTORY.CONTRACT.NUMBER<1-9>: {INVENTORY.CONTRACT.NUMBER<1-9>}
INVENTORY.DEPLOYMENT.STATUS: {INVENTORY.DEPLOYMENT.STATUS}
INVENTORY.DEPLOYMENT.STATUS<1-9>: {INVENTORY.DEPLOYMENT.STATUS<1-9>}
INVENTORY.HARDWARE: {INVENTORY.HARDWARE}
INVENTORY.HARDWARE<1-9>: {INVENTORY.HARDWARE<1-9>}
PROFILE.HARDWARE<1-9>: {PROFILE.HARDWARE<1-9>}
INVENTORY.HARDWARE.FULL: {INVENTORY.HARDWARE.FULL}
INVENTORY.HARDWARE.FULL<1-9>: {INVENTORY.HARDWARE.FULL<1-9>}
INVENTORY.HOST.NETMASK: {INVENTORY.HOST.NETMASK}
INVENTORY.HOST.NETMASK<1-9>: {INVENTORY.HOST.NETMASK<1-9>}
INVENTORY.HOST.NETWORKS: {INVENTORY.HOST.NETWORKS}
INVENTORY.HOST.NETWORKS<1-9>: {INVENTORY.HOST.NETWORKS<1-9>}
INVENTORY.HOST.ROUTER: {INVENTORY.HOST.ROUTER}
INVENTORY.HOST.ROUTER<1-9>: {INVENTORY.HOST.ROUTER<1-9>}
INVENTORY.HW.ARCH: {INVENTORY.HW.ARCH}
INVENTORY.HW.ARCH<1-9>: {INVENTORY.HW.ARCH<1-9>}
INVENTORY.HW.DATE.DECOMM: {INVENTORY.HW.DATE.DECOMM}
INVENTORY.HW.DATE.DECOMM<1-9>: {INVENTORY.HW.DATE.DECOMM<1-9>}
INVENTORY.HW.DATE.EXPIRY: {INVENTORY.HW.DATE.EXPIRY}
INVENTORY.HW.DATE.EXPIRY<1-9>: {INVENTORY.HW.DATE.EXPIRY<1-9>}
INVENTORY.HW.DATE.INSTALL: {INVENTORY.HW.DATE.INSTALL}
INVENTORY.HW.DATE.INSTALL<1-9>: {INVENTORY.HW.DATE.INSTALL<1-9>}
INVENTORY.HW.DATE.PURCHASE: {INVENTORY.HW.DATE.PURCHASE}
INVENTORY.HW.DATE.PURCHASE<1-9>: {INVENTORY.HW.DATE.PURCHASE<1-9>}
INVENTORY.INSTALLER.NAME: {INVENTORY.INSTALLER.NAME}
INVENTORY.INSTALLER.NAME<1-9>: {INVENTORY.INSTALLER.NAME<1-9>}
INVENTORY.LOCATION: {INVENTORY.LOCATION}
INVENTORY.LOCATION<1-9>: {INVENTORY.LOCATION<1-9>}
PROFILE.LOCATION<1-9>: {PROFILE.LOCATION<1-9>}
INVENTORY.LOCATION.LAT: {INVENTORY.LOCATION.LAT}
INVENTORY.LOCATION.LAT<1-9>: {INVENTORY.LOCATION.LAT<1-9>}
INVENTORY.LOCATION.LON: {INVENTORY.LOCATION.LON}
INVENTORY.LOCATION.LON<1-9>: {INVENTORY.LOCATION.LON<1-9>}
INVENTORY.MACADDRESS.A: {INVENTORY.MACADDRESS.A}
INVENTORY.MACADDRESS.A<1-9>: {INVENTORY.MACADDRESS.A<1-9>}
PROFILE.MACADDRESS<1-9>: {PROFILE.MACADDRESS<1-9>}
INVENTORY.MACADDRESS.B: {INVENTORY.MACADDRESS.B}
INVENTORY.MACADDRESS.B<1-9>: {INVENTORY.MACADDRESS.B<1-9>}
INVENTORY.MODEL: {INVENTORY.MODEL}
INVENTORY.MODEL<1-9>: {INVENTORY.MODEL<1-9>}
INVENTORY.NAME: {INVENTORY.NAME}
INVENTORY.NAME<1-9>: {INVENTORY.NAME<1-9>}
PROFILE.NAME<1-9>: {PROFILE.NAME<1-9>}
INVENTORY.NOTES: {INVENTORY.NOTES}
INVENTORY.NOTES<1-9>: {INVENTORY.NOTES<1-9>}
PROFILE.NOTES<1-9>: {PROFILE.NOTES<1-9>}
INVENTORY.OOB.IP: {INVENTORY.OOB.IP}
INVENTORY.OOB.IP<1-9>: {INVENTORY.OOB.IP<1-9>}
INVENTORY.OOB.NETMASK: {INVENTORY.OOB.NETMASK}
INVENTORY.OOB.NETMASK<1-9>: {INVENTORY.OOB.NETMASK<1-9>}
INVENTORY.OOB.ROUTER: {INVENTORY.OOB.ROUTER}
INVENTORY.OOB.ROUTER<1-9>: {INVENTORY.OOB.ROUTER<1-9>}
INVENTORY.OS: {INVENTORY.OS}
INVENTORY.OS<1-9>: {INVENTORY.OS<1-9>}
PROFILE.OS<1-9>: {PROFILE.OS<1-9>}
INVENTORY.OS.FULL: {INVENTORY.OS.FULL}
INVENTORY.OS.FULL<1-9>: {INVENTORY.OS.FULL<1-9>}
INVENTORY.OS.SHORT: {INVENTORY.OS.SHORT}
INVENTORY.OS.SHORT<1-9>: {INVENTORY.OS.SHORT<1-9>}
INVENTORY.POC.PRIMARY.CELL: {INVENTORY.POC.PRIMARY.CELL}
INVENTORY.POC.PRIMARY.CELL<1-9>: {INVENTORY.POC.PRIMARY.CELL<1-9>}
INVENTORY.POC.PRIMARY.EMAIL: {INVENTORY.POC.PRIMARY.EMAIL}
INVENTORY.POC.PRIMARY.EMAIL<1-9>: {INVENTORY.POC.PRIMARY.EMAIL<1-9>}
INVENTORY.POC.PRIMARY.NAME: {INVENTORY.POC.PRIMARY.NAME}
INVENTORY.POC.PRIMARY.NAME<1-9>: {INVENTORY.POC.PRIMARY.NAME<1-9>}
INVENTORY.POC.PRIMARY.NOTES: {INVENTORY.POC.PRIMARY.NOTES}
INVENTORY.POC.PRIMARY.NOTES<1-9>: {INVENTORY.POC.PRIMARY.NOTES<1-9>}
INVENTORY.POC.PRIMARY.PHONE.A: {INVENTORY.POC.PRIMARY.PHONE.A}
INVENTORY.POC.PRIMARY.PHONE.A<1-9>: {INVENTORY.POC.PRIMARY.PHONE.A<1-9>}
INVENTORY.POC.PRIMARY.PHONE.B: {INVENTORY.POC.PRIMARY.PHONE.B}
INVENTORY.POC.PRIMARY.PHONE.B<1-9>: {INVENTORY.POC.PRIMARY.PHONE.B<1-9>}
INVENTORY.POC.PRIMARY.SCREEN: {INVENTORY.POC.PRIMARY.SCREEN}
INVENTORY.POC.PRIMARY.SCREEN<1-9>: {INVENTORY.POC.PRIMARY.SCREEN<1-9>}
INVENTORY.POC.SECONDARY.CELL: {INVENTORY.POC.SECONDARY.CELL}
INVENTORY.POC.SECONDARY.CELL<1-9>: {INVENTORY.POC.SECONDARY.CELL<1-9>}
INVENTORY.POC.SECONDARY.EMAIL: {INVENTORY.POC.SECONDARY.EMAIL}
INVENTORY.POC.SECONDARY.EMAIL<1-9>: {INVENTORY.POC.SECONDARY.EMAIL<1-9>}
INVENTORY.POC.SECONDARY.NAME: {INVENTORY.POC.SECONDARY.NAME}
INVENTORY.POC.SECONDARY.NAME<1-9>: {INVENTORY.POC.SECONDARY.NAME<1-9>}
INVENTORY.POC.SECONDARY.NOTES: {INVENTORY.POC.SECONDARY.NOTES}
INVENTORY.POC.SECONDARY.NOTES<1-9>: {INVENTORY.POC.SECONDARY.NOTES<1-9>}
INVENTORY.POC.SECONDARY.PHONE.A: {INVENTORY.POC.SECONDARY.PHONE.A}
INVENTORY.POC.SECONDARY.PHONE.A<1-9>: {INVENTORY.POC.SECONDARY.PHONE.A<1-9>}
INVENTORY.POC.SECONDARY.PHONE.B: {INVENTORY.POC.SECONDARY.PHONE.B}
INVENTORY.POC.SECONDARY.PHONE.B<1-9>: {INVENTORY.POC.SECONDARY.PHONE.B<1-9>}
INVENTORY.POC.SECONDARY.SCREEN: {INVENTORY.POC.SECONDARY.SCREEN}
INVENTORY.POC.SECONDARY.SCREEN<1-9>: {INVENTORY.POC.SECONDARY.SCREEN<1-9>}
INVENTORY.SERIALNO.A: {INVENTORY.SERIALNO.A}
INVENTORY.SERIALNO.A<1-9>: {INVENTORY.SERIALNO.A<1-9>}
PROFILE.SERIALNO<1-9>: {PROFILE.SERIALNO<1-9>}
INVENTORY.SERIALNO.B: {INVENTORY.SERIALNO.B}
INVENTORY.SERIALNO.B<1-9>: {INVENTORY.SERIALNO.B<1-9>}
INVENTORY.SITE.ADDRESS.A: {INVENTORY.SITE.ADDRESS.A}
INVENTORY.SITE.ADDRESS.A<1-9>: {INVENTORY.SITE.ADDRESS.A<1-9>}
INVENTORY.SITE.ADDRESS.B: {INVENTORY.SITE.ADDRESS.B}
INVENTORY.SITE.ADDRESS.B<1-9>: {INVENTORY.SITE.ADDRESS.B<1-9>}
INVENTORY.SITE.ADDRESS.C: {INVENTORY.SITE.ADDRESS.C}
INVENTORY.SITE.ADDRESS.C<1-9>: {INVENTORY.SITE.ADDRESS.C<1-9>}
INVENTORY.SITE.CITY: {INVENTORY.SITE.CITY}
INVENTORY.SITE.CITY<1-9>: {INVENTORY.SITE.CITY<1-9>}
INVENTORY.SITE.COUNTRY: {INVENTORY.SITE.COUNTRY}
INVENTORY.SITE.COUNTRY<1-9>: {INVENTORY.SITE.COUNTRY<1-9>}
INVENTORY.SITE.NOTES: {INVENTORY.SITE.NOTES}
INVENTORY.SITE.NOTES<1-9>: {INVENTORY.SITE.NOTES<1-9>}
INVENTORY.SITE.RACK: {INVENTORY.SITE.RACK}
INVENTORY.SITE.RACK<1-9>: {INVENTORY.SITE.RACK<1-9>}
INVENTORY.SITE.STATE: {INVENTORY.SITE.STATE}
INVENTORY.SITE.STATE<1-9>: {INVENTORY.SITE.STATE<1-9>}
INVENTORY.SITE.ZIP: {INVENTORY.SITE.ZIP}
INVENTORY.SITE.ZIP<1-9>: {INVENTORY.SITE.ZIP<1-9>}
INVENTORY.SOFTWARE: {INVENTORY.SOFTWARE}
INVENTORY.SOFTWARE<1-9>: {INVENTORY.SOFTWARE<1-9>}
PROFILE.SOFTWARE<1-9>: {PROFILE.SOFTWARE<1-9>}
INVENTORY.SOFTWARE.APP.A: {INVENTORY.SOFTWARE.APP.A}
INVENTORY.SOFTWARE.APP.A<1-9>: {INVENTORY.SOFTWARE.APP.A<1-9>}
INVENTORY.SOFTWARE.APP.B: {INVENTORY.SOFTWARE.APP.B}
INVENTORY.SOFTWARE.APP.B<1-9>: {INVENTORY.SOFTWARE.APP.B<1-9>}
INVENTORY.SOFTWARE.APP.C: {INVENTORY.SOFTWARE.APP.C}
INVENTORY.SOFTWARE.APP.C<1-9>: {INVENTORY.SOFTWARE.APP.C<1-9>}
INVENTORY.SOFTWARE.APP.D: {INVENTORY.SOFTWARE.APP.D}
INVENTORY.SOFTWARE.APP.D<1-9>: {INVENTORY.SOFTWARE.APP.D<1-9>}
INVENTORY.SOFTWARE.APP.E: {INVENTORY.SOFTWARE.APP.E}
INVENTORY.SOFTWARE.APP.E<1-9>: {INVENTORY.SOFTWARE.APP.E<1-9>}
INVENTORY.SOFTWARE.FULL: {INVENTORY.SOFTWARE.FULL}
INVENTORY.SOFTWARE.FULL<1-9>: {INVENTORY.SOFTWARE.FULL<1-9>}
INVENTORY.TAG: {INVENTORY.TAG}
INVENTORY.TAG<1-9>: {INVENTORY.TAG<1-9>}
PROFILE.TAG<1-9>: {PROFILE.TAG<1-9>}
INVENTORY.TYPE: {INVENTORY.TYPE}
INVENTORY.TYPE<1-9>: {INVENTORY.TYPE<1-9>}
PROFILE.DEVICETYPE<1-9>: {PROFILE.DEVICETYPE<1-9>}
INVENTORY.TYPE.FULL: {INVENTORY.TYPE.FULL}
INVENTORY.TYPE.FULL<1-9>: {INVENTORY.TYPE.FULL<1-9>}
INVENTORY.URL.A: {INVENTORY.URL.A}
INVENTORY.URL.A<1-9>: {INVENTORY.URL.A<1-9>}
INVENTORY.URL.B: {INVENTORY.URL.B}
INVENTORY.URL.B<1-9>: {INVENTORY.URL.B<1-9>}
INVENTORY.URL.C: {INVENTORY.URL.C}
INVENTORY.URL.C<1-9>: {INVENTORY.URL.C<1-9>}
INVENTORY.VENDOR: {INVENTORY.VENDOR}
INVENTORY.VENDOR<1-9>: {INVENTORY.VENDOR<1-9>}
ITEM.DESCRIPTION: {ITEM.DESCRIPTION}
ITEM.DESCRIPTION<1-9>: {ITEM.DESCRIPTION<1-9>}
ITEM.DESCRIPTION.ORIG: {ITEM.DESCRIPTION.ORIG}
ITEM.DESCRIPTION.ORIG<1-9>: {ITEM.DESCRIPTION.ORIG<1-9>}
ITEM.ID: {ITEM.ID}
ITEM.ID<1-9>: {ITEM.ID<1-9>}
ITEM.KEY: {ITEM.KEY}
ITEM.KEY<1-9>: {ITEM.KEY<1-9>}
TRIGGER.KEY: {TRIGGER.KEY}
ITEM.KEY.ORIG: {ITEM.KEY.ORIG}
ITEM.KEY.ORIG<1-9>: {ITEM.KEY.ORIG<1-9>}
ITEM.LASTVALUE: {ITEM.LASTVALUE}
ITEM.KEY: {ITEM.KEY}
ITEM.LASTVALUE<1-9>: {ITEM.LASTVALUE<1-9>}
ITEM.LOG.AGE: {ITEM.LOG.AGE}
ITEM.LOG.AGE<1-9>: {ITEM.LOG.AGE<1-9>}
ITEM.LOG.DATE: {ITEM.LOG.DATE}
ITEM.LOG.DATE<1-9>: {ITEM.LOG.DATE<1-9>}
ITEM.LOG.EVENTID: {ITEM.LOG.EVENTID}
ITEM.LOG.EVENTID<1-9>: {ITEM.LOG.EVENTID<1-9>}
ITEM.LOG.NSEVERITY: {ITEM.LOG.NSEVERITY}
ITEM.LOG.NSEVERITY<1-9>: {ITEM.LOG.NSEVERITY<1-9>}
ITEM.LOG.SEVERITY: {ITEM.LOG.SEVERITY}
ITEM.LOG.SEVERITY<1-9>: {ITEM.LOG.SEVERITY<1-9>}
ITEM.LOG.SOURCE: {ITEM.LOG.SOURCE}
ITEM.LOG.SOURCE<1-9>: {ITEM.LOG.SOURCE<1-9>}
ITEM.LOG.TIME: {ITEM.LOG.TIME}
ITEM.LOG.TIME<1-9>: {ITEM.LOG.TIME<1-9>}
ITEM.NAME: {ITEM.NAME}
ITEM.NAME<1-9>: {ITEM.NAME<1-9>}
ITEM.NAME.ORIG: {ITEM.NAME.ORIG}
ITEM.NAME.ORIG<1-9>: {ITEM.NAME.ORIG<1-9>}
ITEM.STATE: {ITEM.STATE}
ITEM.STATE<1-9>: {ITEM.STATE<1-9>}
ITEM.STATE.ERROR: {ITEM.STATE.ERROR}
ITEM.VALUE: {ITEM.VALUE}
ITEM.LASTVALUE: {ITEM.LASTVALUE}
ITEM.VALUE<1-9>: {ITEM.VALUE<1-9>}
ITEM.VALUETYPE: {ITEM.VALUETYPE}
ITEM.VALUETYPE<1-9>: {ITEM.VALUETYPE<1-9>}
LLDRULE.DESCRIPTION: {LLDRULE.DESCRIPTION}
LLDRULE.DESCRIPTION.ORIG: {LLDRULE.DESCRIPTION.ORIG}
LLDRULE.ID: {LLDRULE.ID}
LLDRULE.KEY: {LLDRULE.KEY}
LLDRULE.KEY.ORIG: {LLDRULE.KEY.ORIG}
LLDRULE.NAME: {LLDRULE.NAME}
LLDRULE.NAME.ORIG: {LLDRULE.NAME.ORIG}
LLDRULE.STATE: {LLDRULE.STATE}
LLDRULE.STATE.ERROR: {LLDRULE.STATE.ERROR}
MAP.ID: {MAP.ID}
MAP.NAME: {MAP.NAME}
PROXY.DESCRIPTION: {PROXY.DESCRIPTION}
PROXY.DESCRIPTION: {PROXY.DESCRIPTION}
PROXY.DESCRIPTION: {PROXY.DESCRIPTION}
PROXY.DESCRIPTION<1-9>: {PROXY.DESCRIPTION<1-9>}
PROXY.NAME: {PROXY.NAME}
PROXY.NAME: {PROXY.NAME}
PROXY.NAME: {PROXY.NAME}
PROXY.NAME<1-9>: {PROXY.NAME<1-9>}
SERVICE.DESCRIPTION: {SERVICE.DESCRIPTION}
SERVICE.NAME: {SERVICE.NAME}
SERVICE.ROOTCAUSE: {SERVICE.ROOTCAUSE}
SERVICE.TAGS: {SERVICE.TAGS}
SERVICE.TAGSJSON: {SERVICE.TAGSJSON}
#SERVICE.TAGS.tag name>}: {SERVICE.TAGS.<tag name>}
TIME: {TIME}
TRIGGER.DESCRIPTION: {TRIGGER.DESCRIPTION}
TRIGGER.DESCRIPTION: {TRIGGER.DESCRIPTION}
TRIGGER.COMMENT: {TRIGGER.COMMENT}
TRIGGER.EXPRESSION.EXPLAIN: {TRIGGER.EXPRESSION.EXPLAIN}
TRIGGER.EXPRESSION.RECOVERY.EXPLAIN: {TRIGGER.EXPRESSION.RECOVERY.EXPLAIN}
TRIGGER.EVENTS.ACK: {TRIGGER.EVENTS.ACK}
TRIGGER.EVENTS.PROBLEM.ACK: {TRIGGER.EVENTS.PROBLEM.ACK}
TRIGGER.EVENTS.PROBLEM.UNACK: {TRIGGER.EVENTS.PROBLEM.UNACK}
TRIGGER.EVENTS.UNACK: {TRIGGER.EVENTS.UNACK}
TRIGGER.HOSTGROUP.NAME: {TRIGGER.HOSTGROUP.NAME}
TRIGGER.PROBLEM.EVENTS.PROBLEM.ACK: {TRIGGER.PROBLEM.EVENTS.PROBLEM.ACK}
TRIGGER.PROBLEM.EVENTS.PROBLEM.UNACK: {TRIGGER.PROBLEM.EVENTS.PROBLEM.UNACK}
TRIGGER.EXPRESSION: {TRIGGER.EXPRESSION}
TRIGGER.EXPRESSION.RECOVERY: {TRIGGER.EXPRESSION.RECOVERY}
TRIGGER.ID: {TRIGGER.ID}
TRIGGER.NAME: {TRIGGER.NAME}
EVENT.NAME: {EVENT.NAME}
TRIGGER.NAME.ORIG: {TRIGGER.NAME.ORIG}
TRIGGER.NSEVERITY: {TRIGGER.NSEVERITY}
TRIGGER.SEVERITY: {TRIGGER.SEVERITY}
TRIGGER.STATE: {TRIGGER.STATE}
TRIGGER.STATE.ERROR: {TRIGGER.STATE.ERROR}
TRIGGER.STATUS: {TRIGGER.STATUS}
STATUS: {STATUS}
TRIGGER.TEMPLATE.NAME: {TRIGGER.TEMPLATE.NAME}
TRIGGER.URL: {TRIGGER.URL}
TRIGGER.VALUE: {TRIGGER.VALUE}
TRIGGERS.UNACK: {TRIGGERS.UNACK}
TRIGGERS.PROBLEM.UNACK: {TRIGGERS.PROBLEM.UNACK}
TRIGGERS.ACK: {TRIGGERS.ACK}
TRIGGERS.PROBLEM.ACK: {TRIGGERS.PROBLEM.ACK}
USER.FULLNAME: {USER.FULLNAME}
USER.NAME: {USER.NAME}
USER.SURNAME: {USER.SURNAME}
USER.USERNAME: {USER.USERNAME}
USER.ALIAS: {USER.ALIAS}
$MACRO: {$MACRO}
#MACRO: {#MACRO}
?EXPRESSION: {?EXPRESSION}

EOF
